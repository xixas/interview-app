<div class="app-layout" [class.sidebar-collapsed]="layoutService.config().sidebarCollapsed">
    <!-- Top Toolbar - Compact Desktop Style -->
    <div class="app-toolbar">
        <div class="toolbar-start">
            <!-- Quick Actions -->
            <button 
                pButton 
                type="button" 
                icon="pi pi-bars" 
                class="p-button-text p-button-plain toolbar-button"
                (click)="layoutService.toggleSidebar()"
                pTooltip="Toggle Sidebar"
                tooltipPosition="bottom">
            </button>
        </div>

        <div class="toolbar-center">
            <span class="toolbar-title text-surface-900 dark:text-surface-0">
                Interview Practice Assistant
            </span>
        </div>

        <div class="toolbar-end">
            <!-- Theme Toggle -->
            <button 
                pButton 
                type="button" 
                [icon]="layoutService.isDarkTheme() ? 'pi pi-sun' : 'pi pi-moon'"
                class="p-button-text p-button-plain toolbar-button"
                (click)="toggleTheme()"
                [pTooltip]="layoutService.isDarkTheme() ? 'Switch to Light Mode' : 'Switch to Dark Mode'"
                tooltipPosition="bottom">
            </button>
        </div>
    </div>

    <!-- Main Content Area with Sidebar -->
    <div class="app-body">
        <!-- Sidebar Navigation -->
        <div class="app-sidebar">
            <nav class="sidebar-nav">
                @for (view of layoutService.views; track view.id) {
                    <div 
                        class="nav-item"
                        [class.active]="layoutService.activeView() === view.id"
                        (click)="layoutService.setActiveView(view.id)"
                        [pTooltip]="layoutService.config().sidebarCollapsed ? view.label : ''"
                        tooltipPosition="right">
                        
                        <i [class]="view.icon + ' nav-icon'"></i>
                        
                        @if (!layoutService.config().sidebarCollapsed) {
                            <span class="nav-label">{{ view.label }}</span>
                            
                            @if (view.badge && view.badge > 0) {
                                <span class="nav-badge">{{ view.badge }}</span>
                            }
                        }
                    </div>
                }
            </nav>

            @if (!layoutService.config().sidebarCollapsed) {
                <div class="sidebar-footer">
                    <div class="text-muted-color text-xs px-3 py-2">
                        v1.0.0
                    </div>
                </div>
            }
        </div>

        <!-- Main Content -->
        <main class="app-content">
            <router-outlet></router-outlet>
        </main>
    </div>

    <!-- Status Bar (Desktop-like) -->
    @if (layoutService.config().showStatusBar) {
        <div class="app-statusbar">
            <div class="statusbar-start">
                <!-- Context Remaining -->
                <span class="status-metric">
                    <span [class]="layoutService.contextRemainingColor()">
                        {{ layoutService.apiUsage().contextRemaining }}%
                    </span>
                </span>
                
                <span class="status-separator">|</span>
                
                <!-- Time until reset -->
                <span class="status-metric">
                    <i class="pi pi-clock text-xs mr-1"></i>
                    {{ layoutService.timeUntilReset() }}
                </span>
                
                <span class="status-separator">|</span>
                
                <!-- Token usage -->
                <span class="status-metric">
                    <i class="pi pi-chart-bar text-xs mr-1"></i>
                    {{ layoutService.formatTokens(layoutService.apiUsage().tokensUsed) }} tok 
                    @if (layoutService.apiUsage().tokensPerMinute > 0) {
                        ({{ layoutService.apiUsage().tokensPerMinute }} tpm)
                    }
                </span>
                
                <span class="status-separator">|</span>
                
                <!-- Cost tracking -->
                <span class="status-metric">
                    <i class="pi pi-dollar text-xs mr-1"></i>
                    {{ '$' + layoutService.apiUsage().apiCost.toFixed(2) }}
                    @if (layoutService.apiUsage().costPerHour > 0) {
                        ({{ '$' + layoutService.apiUsage().costPerHour.toFixed(2) }}/h)
                    }
                </span>
            </div>
            
            <div class="statusbar-center">
                <span class="text-muted-color text-xs">
                    {{ currentTime }}
                </span>
            </div>
            
            <div class="statusbar-end">
                <span class="text-muted-color text-xs mr-3">
                    <i class="pi pi-wifi mr-1"></i>
                    Connected
                </span>
                <span class="text-muted-color text-xs">
                    <i class="pi pi-database mr-1"></i>
                    Local DB
                </span>
            </div>
        </div>
    }

    <!-- Global Toast Notifications -->
    <app-global-toast />
</div>